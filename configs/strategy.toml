# configs/strategy.toml
# 〔このファイルがすること〕
# VRLG 戦略の全設定（起動用の既定値）。これまで実装した各モジュールが参照するキーを網羅しています。

[symbol]
name      = "BTCUSD-PERP"  # 〔銘柄名〕
tick_size = 0.5            # 〔価格の最小刻み〕

[signal]
N           = 80     # 〔中央値窓〕DoB の中央値を出すための履歴サイズ
x           = 0.25   # 〔DoB 閾〕中央値の (1-x) 未満で薄板とみなす
y           = 2.0    # 〔スプレッド閾（ticks）〕この値以上で広がったとみなす
z           = 0.6    # 〔位相幅（周期比）〕phase < z or phase > 1-z を境界とする
obi_limit   = 0.6    # 〔OBI 上限〕|OBI| ≤ 0.6 のときだけフェア値近辺を狙う
T_roll      = 30.0   # 〔周期推定のロール窓（秒）〕自己相関・検定の対象期間
# RotationDetector 調整（Step42）
p_thresh             = 0.01  # 〔p値閾〕DoB/Spread ともにこれ未満で Active
period_min_s         = 0.8   # 〔周期探索下限（秒）〕
period_max_s         = 5.0   # 〔周期探索上限（秒）〕
min_boundary_samples = 200   # 〔位相境界の必要サンプル数〕
min_off_samples      = 50    # 〔非境界の必要サンプル数〕

[exec]
order_ttl_ms     = 1000    # 〔TTL（ms）〕未充足はこの時間でキャンセル
display_ratio    = 0.25    # 〔表示量比率〕display = min(max(total×ratio, min_display), total)
min_display_btc  = 0.01    # 〔最小表示量（BTC）〕
max_exposure_btc = 0.8     # 〔メーカー露出の上限（BTC）〕
cooldown_factor  = 2.0     # 〔クールダウン長〕= factor × R*（秒）
# 置き方（Step31）
offset_ticks_normal     = 0.5   # 〔通常置きオフセット〕mid ± 0.5 tick
offset_ticks_deep       = 1.5   # 〔深置きオフセット〕mid ± 1.5 ticks
spread_collapse_ticks   = 1.0   # 〔早期IOC〕スプレッドがこの値以下に縮んだら即クローズ
side_mode               = "both" # 〔発注の向き〕"both" | "buy" | "sell"
# 分割（Step43）
splits           = 1      # 〔子注文本数（片面あたり）〕
# サイズ割当（Step64）
percent_min      = 0.002  # 〔口座比率の下限〕0.2%
percent_max      = 0.005  # 〔口座比率の上限〕0.5%
min_clip_btc     = 0.001  # 〔クリップの最小BTC〕これ未満は発注しない
equity_usd       = 10000.0 # 〔想定口座USD（紙/簡易運用用）〕

[risk]
max_slippage_ticks    = 1.0   # 〔滑り上限（1分平均）〕超で成行禁止＆深置き
max_book_impact       = 0.02  # 〔板消費率（5秒合計）上限〕超でサイズ0.5倍
time_stop_ms          = 1200  # 〔Time-Stop（ms）〕保有がこれを超えたら強制クローズ
stop_ticks            = 3.0   # 〔OCO損切り幅（ticks）〕
block_interval_stop_s = 4.0   # 〔ブロック間隔のkill-switch閾（移動中央値, 秒）〕

[latency]
ingest_ms        = 10   # 〔WS取り込み遅延（ms, BT用注入）〕
order_rt_ms      = 60   # 〔発注RTT（ms, BT用注入）〕
max_staleness_ms = 300  # 〔鮮度ゲート〕特徴量がこの閾超なら発注スキップ

